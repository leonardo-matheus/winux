# =============================================================================
# Winux OS - Systemd System Configuration
# /etc/systemd/system.conf.d/winux.conf
# =============================================================================
# Optimized systemd configuration for gaming and desktop responsiveness
# Based on Winux OS Specification v1.0
# =============================================================================

[Manager]
# =============================================================================
# LOGGING
# =============================================================================

# Log level (err, warning, notice, info, debug)
LogLevel=notice

# Log target (journal, console, kmsg)
LogTarget=journal

# Compress logs
LogColor=yes

# =============================================================================
# CPU AFFINITY
# =============================================================================

# Default CPU affinity for system services
# Leave cores 0-1 for games, use remaining cores for system
# Uncomment and adjust for your CPU
# CPUAffinity=2-7

# =============================================================================
# TIMEOUTS
# =============================================================================

# Default timeout for starting units (faster boot)
DefaultTimeoutStartSec=15s

# Default timeout for stopping units (faster shutdown)
DefaultTimeoutStopSec=10s

# Timeout for stopping user sessions during shutdown
DefaultTimeoutAbortSec=10s

# Default restart delay
DefaultRestartSec=100ms

# Device timeout
DefaultDeviceTimeoutSec=30s

# =============================================================================
# RESOURCE LIMITS
# =============================================================================

# Maximum number of file descriptors
DefaultLimitNOFILE=1048576:1048576

# Maximum number of processes
DefaultLimitNPROC=infinity

# Maximum core file size (0 = disabled)
DefaultLimitCORE=0:0

# Maximum memory lock
DefaultLimitMEMLOCK=infinity:infinity

# Real-time priority limit (for audio, gaming)
DefaultLimitRTPRIO=99:99

# Nice priority range
DefaultLimitNICE=-20:19

# Real-time timeout (microseconds, 0 = no limit)
DefaultLimitRTTIME=infinity

# Stack size limit
DefaultLimitSTACK=8388608:infinity

# Maximum file size
DefaultLimitFSIZE=infinity:infinity

# Maximum virtual memory
DefaultLimitAS=infinity:infinity

# Maximum number of pending signals
DefaultLimitSIGPENDING=infinity

# Maximum message queue size
DefaultLimitMSGQUEUE=819200:819200

# =============================================================================
# OOM (Out of Memory) POLICY
# =============================================================================

# Default OOM policy for services
DefaultOOMPolicy=stop

# Default OOM score adjustment
DefaultOOMScoreAdjust=0

# =============================================================================
# SCHEDULING
# =============================================================================

# Default IO scheduling class and priority
DefaultIOSchedulingClass=best-effort
DefaultIOSchedulingPriority=4

# Default CPU scheduling policy
DefaultCPUSchedulingPolicy=other

# Default nice level for services
DefaultNice=0

# =============================================================================
# MEMORY PRESSURE
# =============================================================================

# Default memory pressure watch configuration
DefaultMemoryPressureWatch=auto
DefaultMemoryPressureThresholdSec=200ms

# =============================================================================
# CGROUPS
# =============================================================================

# Use unified cgroup hierarchy (v2)
# DefaultCPUAccounting=yes
# DefaultIOAccounting=yes
# DefaultMemoryAccounting=yes
# DefaultTasksAccounting=yes

# =============================================================================
# WATCHDOG
# =============================================================================

# Runtime watchdog (reboot if system hangs)
RuntimeWatchdogSec=0

# Reboot watchdog
RebootWatchdogSec=10min

# Kexec watchdog
KExecWatchdogSec=0

# Watchdog device
# WatchdogDevice=/dev/watchdog

# =============================================================================
# CRASH HANDLING
# =============================================================================

# Crash behavior
CrashChangeVT=no
CrashShell=no
CrashReboot=no

# Dump core on crash
DumpCore=no

# =============================================================================
# SYSTEMD STATUS
# =============================================================================

# Show status on boot
ShowStatus=yes

# Status unit format
StatusUnitFormat=combined

# =============================================================================
# SLEEP / HIBERNATION
# =============================================================================

# Default action when lid is closed (laptop)
# Handled by logind.conf, not here

# =============================================================================
# CAPABILITIES
# =============================================================================

# Default capability bounding set (keep all by default)
# CapabilityBoundingSet=

# =============================================================================
# TIMER SLACK
# =============================================================================

# Default timer slack for services (lower = more precise but uses more power)
DefaultTimerAccuracySec=1min

# =============================================================================
# ENVIRONMENT
# =============================================================================

# Default environment variables for all services
DefaultEnvironment="LANG=en_US.UTF-8" "LC_COLLATE=C"

# =============================================================================
# End of Winux OS Systemd Configuration
# =============================================================================
