<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
  "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- D-Bus policy for com.winux.AI system service -->

  <!-- Only the winux-ai user can own the service name -->
  <policy user="winux-ai">
    <allow own="com.winux.AI"/>
    <allow send_destination="com.winux.AI"/>
    <allow receive_sender="com.winux.AI"/>
  </policy>

  <!-- Allow root to access the service (for administrative purposes) -->
  <policy user="root">
    <allow send_destination="com.winux.AI"/>
    <allow receive_sender="com.winux.AI"/>
  </policy>

  <!-- Allow all users to call methods on the AI service -->
  <policy context="default">
    <allow send_destination="com.winux.AI"
           send_interface="com.winux.AI"/>
    <allow send_destination="com.winux.AI"
           send_interface="org.freedesktop.DBus.Properties"/>
    <allow send_destination="com.winux.AI"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow receive_sender="com.winux.AI"/>
  </policy>

  <!-- Deny all by default (safety) then allow specific interfaces above -->
  <policy context="default">
    <deny send_destination="com.winux.AI"
          send_interface="org.freedesktop.DBus.Peer"/>
  </policy>
</busconfig>
