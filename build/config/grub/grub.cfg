# Winux OS - GRUB Configuration Template
# SPDX-License-Identifier: GPL-3.0-or-later

# Default boot entry
set default=0

# Timeout in seconds
set timeout=5

# Enable graphical terminal
set gfxmode=auto
set gfxpayload=keep

# Load video modules
insmod all_video
insmod gfxterm
insmod png

# Set terminal output
terminal_output gfxterm

# Load theme if available
if [ -f ${prefix}/themes/winux/theme.txt ]; then
    insmod gfxmenu
    set theme=${prefix}/themes/winux/theme.txt
fi

# Color configuration
set menu_color_normal=white/black
set menu_color_highlight=black/light-blue

# Winux OS - Main Entry
menuentry "Winux OS" --class winux --class gnu-linux --class gnu --class os {
    set gfxpayload=keep
    linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw quiet splash loglevel=3 rd.udev.log_priority=3 vt.global_cursor_default=0
    initrd /boot/initramfs-linux.img
}

# Winux OS - Recovery Mode
menuentry "Winux OS (Recovery Mode)" --class winux --class gnu-linux --class gnu --class os {
    set gfxpayload=keep
    linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw single
    initrd /boot/initramfs-linux.img
}

# Winux OS - Fallback
menuentry "Winux OS (Fallback initramfs)" --class winux --class gnu-linux --class gnu --class os {
    set gfxpayload=keep
    linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw
    initrd /boot/initramfs-linux-fallback.img
}

# Advanced options submenu
submenu "Advanced options for Winux OS" --class submenu {
    menuentry "Winux OS - Verbose Boot" --class winux --class gnu-linux --class gnu --class os {
        set gfxpayload=keep
        linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw
        initrd /boot/initramfs-linux.img
    }

    menuentry "Winux OS - Debug Mode" --class winux --class gnu-linux --class gnu --class os {
        set gfxpayload=keep
        linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw debug systemd.log_level=debug
        initrd /boot/initramfs-linux.img
    }

    menuentry "Winux OS - Safe Graphics" --class winux --class gnu-linux --class gnu --class os {
        set gfxpayload=keep
        linux /boot/vmlinuz-linux root=UUID=@ROOT_UUID@ rw nomodeset
        initrd /boot/initramfs-linux.img
    }
}

# UEFI Firmware Settings (if available)
if [ ${grub_platform} == "efi" ]; then
    menuentry "UEFI Firmware Settings" --class settings {
        fwsetup
    }
fi

# System shutdown and restart
menuentry "System shutdown" --class shutdown {
    echo "System shutting down..."
    halt
}

menuentry "System restart" --class restart {
    echo "System restarting..."
    reboot
}
